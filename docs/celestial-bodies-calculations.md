# Положения небесных тел
Положения небесных тел в **DEPHEM** определяются при помощи метода `calculateBody` объекта класса `dph::EphemerisRelease` (**dephem/EphemerisRelease.hpp**). 

**Содержание раздела:**
* Особенности использования `calculateBody`
    * Доступные тела
    * Результат вычислений
    * Единицы измерения
    * Система координат
    * Формат времени
* Описание `calculateBody`
    * Сигнатура метода
    * Передаваемые парамерты
    * Особенности работы метода
* Примеры использования `calculateBody`

## Особенности использования `calculateBody`

### Доступные тела
Используя любой **официальный** выпуск DE-эфемерид (см. раздел "[О файлах эфемерид](about-ephemeris-files.md)") можно определить положения следующих небесных тел:
* Меркурий
* Венера
* Земля
* Марс
* Юпитер
* Сатурн
* Уран
* Нептун
* Плутон
* Луна
* Солнце
* Барицентр Солнечной Системы
* Барицентр системы Земля-Луна

Положение каждого небесного тела из списка можно узнать относительно любого другого.

Для доступа к индексам небесных тел обратитесь к классу `dph::Body` (**dephem/help.hpp**, включён в **dephem/EphemerisRelease.hpp** по-умолчанию).

### Результат вычислений
Метод `calculateBody` предоставляет возможность определить не только положение (радиус-вектор), но и вектор состояния небесного тела (радиус-вектор + вектор сокростей).

Для доступа к индексам поддерживаемых результатов рассчёта обратитесь к классу `dph::Calculate` (**dephem/help.hpp**, включён в **dephem/EphemerisRelease.hpp** по-умолчанию).

### Единицы измерения
|Результат вычисления|Количество компонент|Компоненты|Единицы измерения|
|:-:|:-:|:-:|:-:|
|Положение `dph::Calculate::POSITION`|3|(x, y, z)|км|
|Состояние `dph::Calculate::STATE`|6|(x, y, z), (Vx, Vy, Vz) |км, км/сек|

### Система координат
В разных выпусках эфемерид используются разные системы координат.

Для выпуска **DE102** используется *СК B1950.0*. 
Для **DE200** и **DE202** используется *СК J2000.0*. 
Начиная с **DE403** Используется *СК ICRF*. 
Далее, начиная с **DE423** и для всех последующих используется *СК ICRF2.0*.

### Формат времени
**Внимание!** Для вычислений используется эфемеридное время в формате Юлианской Даты (JED - Julian Ephemeris Date).

Более подробно:
* [Юлианская дата, Википедия](https://ru.wikipedia.org/wiki/Юлианская_дата)
* [Эфемеридное время, Википедия](https://ru.wikipedia.org/wiki/Эфемеридное_время)

## Описание `calculateBody`

### Сигнатура метода
````c++
void dph::EphemerisRelease::calculateBody(unsigned calculationResult, 
unsigned targetBody, unsigned centerBody, double JED, double* resultArray) const
````

### Передаваемые параметры
>calculationResult

Индекс результата вычислений. В зависимости от значения параметра меняется результат вычислений. Вместо числовых значений используйте значения, хранимые в классе `dph::Calculate`.

При передаче значения не предусмотренного в `dph::Calculate` метод завершит работу.

>targetBody

Индекс искомого тела. Вместо числовых значений используйте значения, хранимые в классе `dph::Body`.

При передаче значения не предусмотренного в `dph::Body` метод завершит работу.

>centerBody

Индекс центрального тела. Значения для искомого тела `targetBody` будут посчитаны относительно тела `centerBody`.

При передаче значения не предусмотренного в `dph::Body` метод завершит работу.

>JED

Момент времени на который требуется определеить значения для искомого тела `targetBody`.

Момент времени `JED` должен принадлежать промежутку [`startDate` : `endDate`] (см. "[Примеры использования](usage-examples.md)"). В противном случае метод завершит работу.

>resultArray

Указатель на массив типа `double`, в который будет записан результат вычислений.

Убедитесь, что передаёте массив достаточного размера для выбранных параметров.  
При передаче нулевого указателя метод завершит работу.

### Особенности работы метода
Если объект не готов к работе (используй `isReady`, см. "[Примеры использования](usage-examples.md)"), то метод завершит работу.


## Примеры использования `calculateBody`

**Пример #1**
Получить положение Марса относительно Солнца на момент времени 2451544.5:
````c++
dph::EphemerisRelease de431("lnxm13000p17000.431");

if(de431.isReady())
{
    double JED = 2451544.5;
    
    if(JED >= de431.startDate() && JED <= de431.endDate())
    {
        double resultArray[3]{};

        de431.calculateBody(dph::Calculate::POSITION, dph::Body::MARS, dph::Body::SUN, 
        JED, resultArray);
    }
}
````

**Пример #2**
Получить вектор состояния Луны относительно Земли на момент времени 2451544.5:
````c++
dph::EphemerisRelease de431("lnxm13000p17000.431");

if(de431.isReady())
{
    double JED = 2451544.5;
    
    if(JED >= de431.startDate() && JED <= de431.endDate())
    {
        double resultArray[6]{};

        de431.calculateBody(dph::Calculate::STATE, dph::Body::MOON, dph::Body::EARTH, 
        JED, resultArray);
    }
}
````

---
[Вернуться к оглавлению](index.md)